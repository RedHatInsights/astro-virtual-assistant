{"meta":{"count":8},"links":{"first":"/api/insights/v1/rule/?filter%5Bsystem_profile%5D%5Bsap_system%5D=true&impacting=true&limit=3&offset=0&rule_status=enabled&sort=-publish_date","next":"/api/insights/v1/rule/?filter%5Bsystem_profile%5D%5Bsap_system%5D=true&impacting=true&limit=3&offset=3&rule_status=enabled&sort=-publish_date","previous":"/api/insights/v1/rule/?filter%5Bsystem_profile%5D%5Bsap_system%5D=true&impacting=true&limit=3&offset=0&rule_status=enabled&sort=-publish_date","last":"/api/insights/v1/rule/?filter%5Bsystem_profile%5D%5Bsap_system%5D=true&impacting=true&limit=3&offset=5&rule_status=enabled&sort=-publish_date"},"data":[{"rule_id":"hardening_ssh_hmac_cipher_rhel8_later|SSH_INSECURE_HMAC_CIPHER_RHEL8_LATER_CRYPTO","created_at":"2024-07-10T08:33:32.150138Z","updated_at":"2024-11-22T14:34:04.762842Z","description":"SSH security is decreased when insecure cipher or hmac is enabled in the crypto policy","active":true,"category":{"id":2,"name":"Security"},"impact":{"name":"Decreased Security","impact":3},"likelihood":4,"node_id":"7041246","tags":"crypto-policy incident security ssh","playbook_count":1,"reboot_required":false,"publish_date":"2024-07-18T20:27:00Z","summary":"SSH security is decreased when insecure cipher or hmac is enabled in the crypto policy.\n","generic":"SSH security is decreased when insecure cipher or hmac is enabled in the crypto policy.\n","reason":"This **{{=pydata.rhel}}** system is running with `sshd` service running. Insecure cipher(cbc) or mac(sha1,md5) is configured from {{?pydata.crypto_enabled}}{{?pydata.issue_configurations_for_resolution.length > 0}}the crypto-policy{{?}}{{?pydata.issue_configurations_for_resolution.length > 0 && pydata.crypto_enabled_sshd_issue_configurations && pydata.crypto_enabled_sshd_issue_configurations.length > 0}} and {{?}}{{?pydata.crypto_enabled_sshd_issue_configurations && pydata.crypto_enabled_sshd_issue_configurations.length > 0}}the `sshd` configuration file{{?}}{{??}}the `sshd` configuration file{{?}}.\n\n{{?pydata.crypto_enabled}}\n{{?pydata.issue_configurations_for_resolution.length > 0}}\n{{ for (var key in pydata.issue_configurations) { }}\n* Insecure {{=key}} from the crypto-policy: {{~pydata.issue_configurations[key]:item}} {{=item}} {{~}}\n{{ } }}\n{{?}}\n{{?pydata.crypto_enabled_sshd_issue_configurations && pydata.crypto_enabled_sshd_issue_configurations.length > 0}}\n{{~pydata.crypto_enabled_sshd_issue_configurations:item}}\n{{?item[1]}}\n* Insecure setting from the `sshd` configuration file `{{=item[0]}}`: {{=item[1]}}  \n{{?}}\n{{~}}\n{{?}}\n{{??}}\n{{~pydata.issue_configurations:item}}\n  {{?item[1]}}\n  ~~~\n  Configuration file: {{=item[0]}}\n  Issue Line: {{=item[1]}}\n\n  ~~~\n  {{?}}\n{{~}}\n{{?}}\n","more_info":"","impacted_systems_count":9,"reports_shown":true,"rule_status":"enabled","resolution_set":[{"system_type":105,"resolution":"Red Hat recommends that you perform the following steps:\n\n{{?pydata.crypto_enabled}}\n{{?pydata.issue_configurations_for_resolution.length > 0}}\n{{?pydata.update_info.unset_lock}}\n* Unset the release lock.\n  ~~~\n  # subscription-manager release --unset\n  ~~~ \n{{?}}\n{{?pydata.update_info.enable_repo}}\n* Enable the RHEL base repo.\n  ~~~\n  # subscription-manager repos --enable=rhel-8-for-x86_64-baseos-rpms\n  ~~~\n{{?}}\n{{?pydata.update_info.update_package}}\n* Update **crypto-policies** package.\n  ~~~\n  # dnf update crypto-policies\n  ~~~\n{{?}}\n{{?pydata.rhel.indexOf(\"9.\") != -1 && pydata.update_info.include_miss}}\n* Add the following configuration into `/etc/ssh/sshd_config`:\n  ~~~\n  Include /etc/ssh/sshd_config.d/*.conf\n  ~~~\n{{?}}\n* Add a pmod file into `/etc/crypto-policies/policies/modules/DISABLE-INSECURE-INSIGHTS.pmod` with the following content.\n  ~~~\n  {{~ pydata.issue_configurations_for_resolution: item}}{{=item}}\n  {{~}}\n  ~~~\n\n* Apply the new crypto policy file.\n  ~~~\n  # update-crypto-policies --set {{=pydata.update_info.current_policy}}:DISABLE-INSECURE-INSIGHTS\n  ~~~\n{{?}}\n{{? pydata.crypto_enabled_sshd_issue_configurations && pydata.crypto_enabled_sshd_issue_configurations.length > 0}}\n* Apply the following setting{{?pydata.crypto_enabled_sshd_issue_configurations.length > 1}}s{{?}}.\n\n  {{~pydata.crypto_enabled_sshd_issue_configurations:item}}\n  ~~~\n  Configuration file: {{=item[0]}}\n  {{?item[1]}}\n  Issue Line: {{=item[1]}}\n  Updated Line: {{=item[2]}}\n  {{??}}\n  Added Line: {{=item[2]}}\n  {{?}}\n\n  ~~~\n  {{~}}\n**NOTE:** The **Updated Line** and **Added Line** are recommended by Red Hat, you can adjust the setting according to the business requirement.\n{{?}}\n{{??}}\n* Apply the following setting{{?pydata.issue_configurations.length > 1}}s{{?}}.\n\n  {{~pydata.issue_configurations:item}}\n  ~~~\n  Configuration file: {{=item[0]}}\n  {{?item[1]}}\n  Issue Line: {{=item[1]}}\n  Updated Line: {{=item[2]}}\n  {{??}}\n  Added Line: {{=item[2]}}\n  {{?}}\n\n  ~~~\n  {{~}}\n**NOTE:** The **Updated Line** and **Added Line** are recommended by Red Hat, you can adjust the setting according to the business requirement.\n{{?}}\n* Restart **sshd** service.\n  ~~~\n  # systemctl restart sshd.service\n  ~~~\n\n\nAfter applying the remediation, refresh the results of Advisor analysis by running the `insights-client` command on the system. \n~~~ \n# insights-client \n~~~ \n","resolution_risk":{"name":"Update Service Configuration","risk":1},"has_playbook":true}],"total_risk":3,"hosts_acked_count":0,"rating":0},{"rule_id":"sap_subscription_check|SAP_SUBSCRIPTION_ISSUE_V2","created_at":"2024-07-04T08:33:28.175174Z","updated_at":"2024-11-19T08:34:13.142193Z","description":"SAP instance encounters supportability issues when not having appropriate RHEL for SAP repositories enabled","active":true,"category":{"id":3,"name":"Stability"},"impact":{"name":"Invalid Configuration","impact":1},"likelihood":4,"node_id":"34169","tags":"sap sbr_sysmgmt sysmgmt","playbook_count":1,"reboot_required":false,"publish_date":"2024-07-07T04:44:00Z","summary":"RHEL systems for SAP must be subscribed to the **RHEL for SAP Solutions** or **RHEL for SAP Applications** subscription in order to maintain functionality.\n","generic":"RHEL systems for SAP must be subscribed to the **RHEL for SAP Solutions** or **RHEL for SAP Applications** subscription in order to maintain functionality.\n","reason":"This system is currently running Red Hat Enterprise Linux with the following SAP instance{{?pydata.sap.length > 1}}s{{?}}:\n{{~pydata.sap: e}}* {{=e}}\n{{~}}\n\nThe {{?pydata.rhel[0] == '7'}}yum{{??}}dnf{{?}} repositories for the above SAP instance{{?pydata.sap.length > 1}}s are{{??}} is{{?}} not set correctly and supportability issues with SAP products will occur.\n","more_info":"For more information about RHEL for SAP Solutions and RHEL for SAP Applications, refer to the following documents:\n{{?pydata.subs&&pydata.subs.indexOf('Solutions') != -1}}\n* [Overview of the Red Hat Enterprise Linux for SAP Solutions subscription](https://access.redhat.com/solutions/3082481){{?}} {{?pydata.subs&&pydata.subs.indexOf('Applications') != -1}}\n* [Overview of the Red Hat Enterprise Linux for SAP Applications subscription](https://access.redhat.com/solutions/34169){{?}}{{?pydata.rhel.indexOf(\"9.\") != -1}}\n* [3108316 - Red Hat Enterprise Linux 9.x: Installation and Configuration](https://me.sap.com/notes/3108316){{?}}{{?pydata.rhel.indexOf(\"8.\") != -1}}\n* [2772999 - Red Hat Enterprise Linux 8.x: Installation and Configuration](https://launchpad.support.sap.com/#/notes/2772999){{?}}{{?pydata.rhel.indexOf(\"7.\") != -1}}\n* [2002167 - Red Hat Enterprise Linux 7.x: Installation and Upgrade](https://launchpad.support.sap.com/#/notes/2002167){{?}}}{{?pydata.rhel.indexOf(\"6.\") != -1}}\n* [1496410 - Red Hat Enterprise Linux 6.x: Installation and Upgrade](https://launchpad.support.sap.com/#/notes/1496410){{?}}\n","impacted_systems_count":9,"reports_shown":true,"rule_status":"enabled","resolution_set":[{"system_type":105,"resolution":"{{?pydata.subs&&pydata.subs.indexOf('Solutions') != -1 && pydata.rhel != '8.10'}}\nWhen running SAP HANA on RHEL it must be ensured that only OS packages provided for the specific RHEL minor release are installed. For supportability it is therefore required that only either the EUS or E4S repos are active on the system.\n{{?}}\nThe following {{?pydata.mis_repos.length>1}}repositories{{??}}repository{{?}} should be enabled on this host:\n{{~pydata.mis_repos: e}}* {{=e}}\n{{~}}\nRed Hat recommends that you perform the following steps to enable {{?pydata.mis_repos.length>1}}these repos{{??}}this repo{{?}}:\n{{?pydata.sca == false}}\n1. Find the serial number for current subscription:\n   ~~~\n   # subscription-manager list --consumed\n   ~~~\n1. Remove the system from the current subscription:\n   ~~~\n   # subscription-manager remove --serial='SERIAL NUMBER'\n   ~~~\n1. Find the pool ID for the **RHEL for SAP** subscription:\n   ~~~\n   # subscription-manager list --available\n   ~~~\n1. Subscribe to **RHEL for SAP** using the pool ID:\n   ~~~\n   # subscription-manager attach --pool='XXXX'\n   ~~~\n{{?}}\n1. Enable the recommended {{?pydata.rhel[0] == '7'}}yum{{??}}dnf{{?}} repositories:\n   ~~~\n   # subscription-manager repos{{~pydata.mis_repos: e}} --enable={{=e}}{{~}}\n   ~~~\n1. Review the {{?pydata.rhel[0] == '7'}}yum{{??}}dnf{{?}} repolist and ensure that **RHEL for SAP** is enabled:\n   ~~~\n   # {{?pydata.rhel[0] == '7'}}yum{{??}}dnf{{?}} repolist\n   ~~~\n\n\nAfter applying the remediation, refresh the results of Advisor analysis by running the `insights-client` command on the system. \n~~~ \n# insights-client \n~~~ \n","resolution_risk":{"name":"Update RHSM Configuration","risk":2},"has_playbook":true}],"total_risk":2,"hosts_acked_count":0,"rating":0},{"rule_id":"sap_limits|SAP_LIMITS_ISSUE_V2","created_at":"2022-10-12T08:31:27.394818Z","updated_at":"2024-11-19T08:34:12.908116Z","description":"SAP instances failure occur when the values for some resource limits are below the SAP recommended values","active":true,"category":{"id":4,"name":"Performance"},"impact":{"name":"Application Failure","impact":3},"likelihood":3,"node_id":"","tags":"kernel sap sbr_kernel tuning","playbook_count":2,"reboot_required":false,"publish_date":"2022-10-16T04:49:00Z","summary":"SAP applications require certain file handler or process resource in order to keep the application running properly. When resource limits are below the SAP recommendations, the SAP instances will fail to run.\n","generic":"SAP applications require certain file handler or process resource in order to keep the application running properly. When resource limits are below the SAP recommendations, the SAP instances will fail to run.\n","reason":"The following limits are out of line with SAP recommendations:\n\n{{ for (key in pydata.untuned) {}}\n* {{? pydata.untuned[key] == 'missing' }}Necessary line for `{{=key}}` is missing.{{??}}{{=key}} {{=pydata.untuned[key]}}{{?}}\n{{ }}}\n","more_info":"For more information about configuring process resource limits for SAP instances, refer to the following SAP Note:\n* [1771258 - Linux: User and system resource limits](https://launchpad.support.sap.com/#/notes/1771258)\n","impacted_systems_count":9,"reports_shown":true,"rule_status":"enabled","resolution_set":[{"system_type":105,"resolution":"Red Hat recommends that you complete the following steps to improve application performance:\n\n{{for (var file in pydata.recommended) { }}\n1. Add/update the following lines in the `{{=file}}`:\n   {{for (var item in pydata.recommended[file]) { }}\n   ~~~\n   {{=pydata.recommended[file][item][0]}} {{=pydata.recommended[file][item][1]}} {{=pydata.recommended[file][item][2]}} {{=pydata.recommended[file][item][3]}}\n   ~~~ {{ } }} {{ } }}\n1. The modification above requires a logout to take effect for newly started processes.  \n   **Note:** Rebooting the system can also take the settings into effect\n1. After re-logging in/rebooting,run the following command to check the current resource limits:\n   ~~~\n   # ulimit -a\n   ~~~\n\n\nAfter applying the remediation, refresh the results of Advisor analysis by running the `insights-client` command on the system. \n~~~ \n# insights-client \n~~~ \n","resolution_risk":{"name":"Limits Tuning","risk":2},"has_playbook":true}],"total_risk":3,"hosts_acked_count":0,"rating":0}]}