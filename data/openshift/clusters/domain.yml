version: "3.1"

intents:
  - intent_openshift_where_cloud
  - intent_openshift_where_on_premise
  - intent_openshift_where_virtualized
  - intent_openshift_provider_aws
  - intent_openshift_provider_google
  - intent_openshift_provider_microsoft
  - intent_openshift_provider_other
  - intent_openshift_managed_yes
  - intent_openshift_managed_no

slots:
  openshift_where:
      type: any
      mappings:
        - type: from_intent
          intent: intent_openshift_where_cloud
          value: cloud
          conditions:
            - active_loop: form_openshift_clusters_create-cluster
              requested_slot: openshift_where
        - type: from_intent
          intent: intent_openshift_where_on_premise
          value: on_premise
          conditions:
            - active_loop: form_openshift_clusters_create-cluster
              requested_slot: openshift_where
        - type: from_intent
          intent: intent_openshift_where_virtualized
          value: virtualized
          conditions:
            - active_loop: form_openshift_clusters_create-cluster
              requested_slot: openshift_where
  openshift_provider:
      type: any
      mappings:
        - type: from_intent
          intent: intent_openshift_provider_aws
          value: aws
          conditions:
            - active_loop: form_openshift_clusters_create-cluster
              requested_slot: openshift_provider
        - type: from_intent
          intent: intent_openshift_provider_google
          value: google
          conditions:
            - active_loop: form_openshift_clusters_create-cluster
              requested_slot: openshift_provider
        - type: from_intent
          intent: intent_openshift_provider_microsoft
          value: microsoft
          conditions:
            - active_loop: form_openshift_clusters_create-cluster
              requested_slot: openshift_provider
        - type: from_intent
          intent: intent_openshift_provider_other
          value: other
          conditions:
            - active_loop: form_openshift_clusters_create-cluster
              requested_slot: openshift_provider
  openshift_managed:
      type: any
      mappings:
        - type: from_intent
          intent: intent_openshift_managed_yes
          value: yes
          conditions:
            - active_loop: form_openshift_clusters_create-cluster
              requested_slot: openshift_managed
        - type: from_intent
          intent: intent_openshift_managed_no
          value: no
          conditions:
            - active_loop: form_openshift_clusters_create-cluster
              requested_slot: openshift_managed
        - type: from_intent
          intent: intent_affirm
          value: yes
          conditions:
            - active_loop: form_openshift_clusters_create-cluster
              requested_slot: openshift_managed
        - type: from_intent
          intent: intent_deny
          value: no
          conditions:
            - active_loop: form_openshift_clusters_create-cluster
              requested_slot: openshift_managed
  openshift_hosted:
    type: any
    mappings:
      - type: custom
  openshift_is_correct:
    type: bool
    mappings:
      - type: from_intent
        intent: intent_affirm
        value: true
        conditions:
          - active_loop: form_openshift_clusters_create-cluster
            requested_slot: openshift_is_correct
      - type: from_intent
        intent: intent_deny
        value: false
        conditions:
          - active_loop: form_openshift_clusters_create-cluster
            requested_slot: openshift_is_correct

forms:
  form_openshift_clusters_create-cluster:
    # Specifying the slots here silence UserWarning extract_ about these slots
    # These can be overriden by the actions
    required_slots: [openshift_where, openshift_provider, openshift_managed, openshift_hosted, openshift_is_correct]

responses:
  utter_openshift_clusters_create-cluster:
    - text: Sure, I can help you create an OpenShift cluster that fits your needs. First, let me ask you a few questions.
  utter_ask_form_openshift_clusters_create-cluster_openshift_where:
    - text: Tell us where your hosts live.
      buttons:
        - title: Public cloud
          payload: Public cloud
        - title: On premise
          payload: On premise
        - title: Virtualized
          payload: Virtualized
  utter_ask_form_openshift_clusters_create-cluster_openshift_provider:
    - text: Okay. Which cloud provider do you use?
      buttons:
        - title: Amazon Web Services
          payload: Amazon Web Services
        - title: Google Cloud Platform
          payload: Google Cloud Platform
        - title: Microsoft Azure
          payload: Microsoft Azure
  utter_ask_form_openshift_clusters_create-cluster_openshift_managed:
    - text: Alright. Do you want Red Hat to manage the cluster for you?
      buttons:
        - title: Red Hat
          payload: Red Hat
        - title: I’ll manage it myself
          payload: I’ll manage it myself
  utter_ask_form_openshift_clusters_create-cluster_openshift_hosted:
    - text: Got it. Is this cluster's control plane going to be hosted or standalone?
      buttons:
        - title: Hosted
          payload: Hosted
        - title: Standalone
          payload: Standalone

actions:
  - validate_form_openshift_clusters_create-cluster
  - action_ask_form_openshift_clusters_create-cluster_openshift_is_correct
